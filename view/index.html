<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brrrowser | WebXR</title>
    
    <meta name="apple-itunes-app" content="app-id=X824M7L4ZX, app-clip-bundle-id=jp.kidsfab.Brrrowser.Clip">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

    <style>
        :root {
            --bg: #000000;
            --accent: #00f2ff; 
            --text: #ffffff;
            --text-dim: #777777;
        }

        body {
            background-color: var(--bg);
            color: var(--text);
            font-family: -apple-system, "SF Pro Display", sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(40px);
            -webkit-backdrop-filter: blur(40px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 40px 30px;
            border-radius: 40px;
            text-align: center;
            width: 85%;
            max-width: 300px;
        }

        /* Container for QR Code */
        #qrcode {
            display: flex;
            justify-content: center;
            margin-bottom: 25px;
            padding: 15px;
            background: white; /* QR codes work best with high contrast */
            border-radius: 20px;
            width: fit-content;
            margin-left: auto;
            margin-right: auto;
        }

        p {
            font-size: 16px;
            font-weight: 500;
            line-height: 1.4;
            margin-bottom: 30px;
        }

        .powered-by {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            opacity: 0.6;
        }

        .powered-text {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--text-dim);
        }

        .mini-logo {
            width: 24px;
        }

        .tagline {
            font-size: 13px;
            font-weight: 400;
            color: var(--text-dim);
        }
    </style>
</head>
<body>
    <div class="glass-card">
        <div id="qrcode" style="display: none;"></div>
        
        <p id="instruction-text">Detecting device...</p>
        
        <div class="powered-by">
            <span class="powered-text">Powered by</span>
            <img src="https://web3kev.github.io/Brrrowser/assets/IconBrrr.png" alt="Brrrowser" class="mini-logo">
            <span class="powered-text">Brrrowser</span>
            <span class="tagline">Web Haptic & Web AR browser</span>
        </div>
    </div>

    <script>
        function init() {
            const el = document.getElementById('instruction-text');
            const qrContainer = document.getElementById('qrcode');
            
            // 1. Get URL parameters
            const urlParams = new URLSearchParams(window.location.search);
            const hasUrlParam = urlParams.has('url');

            // 2. Device Detection Logic
            const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) || 
                          (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1);

            const isSafari = isIOS && 
                             /Safari/i.test(navigator.userAgent) && 
                             !/CriOS/i.test(navigator.userAgent) && 
                             !/FxiOS/i.test(navigator.userAgent);

            // 3. Handle QR Code Generation
            if (hasUrlParam) {
                qrContainer.style.display = 'block';
                new QRCode(qrContainer, {
                    text: window.location.href, // Generates QR for the full current URL
                    width: 180,
                    height: 180,
                    colorDark : "#000000",
                    colorLight : "#ffffff",
                    correctLevel : QRCode.CorrectLevel.H
                });
            }

            // 4. Update Instructions
            if (isIOS && isSafari) {
                el.innerHTML = "Use the App Clip banner at the top to enter immersive mode.";
            } else if (hasUrlParam) {
                el.innerHTML = "Scan this code with your iPhone or iPad to open in Brrrowser.";
            } else {
                el.innerHTML = "Open this page on an iPhone or iPad in Safari to invoke the app.";
            }
        }

        // Run on load
        window.onload = init;
    </script>
</body>
</html>
