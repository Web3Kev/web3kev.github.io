<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brrrowser | WebXR</title>
    
    <meta name="apple-itunes-app" content="app-id=X824M7L4ZX, app-clip-bundle-id=jp.kidsfab.Brrrowser.Clip">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

    <style>
        :root {
            --bg: #000000;
            --accent: #00f2ff; 
            --text: #ffffff;
            --text-dim: #777777;
        }

        body {
            background-color: var(--bg);
            color: var(--text);
            font-family: -apple-system, "SF Pro Display", sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(40px);
            -webkit-backdrop-filter: blur(40px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 40px 30px;
            border-radius: 40px;
            text-align: center;
            width: 85%;
            max-width: 320px;
        }

        /* Container for QR Code */
        #qrcode {
            display: flex;
            justify-content: center;
            margin-bottom: 25px;
            padding: 15px;
            background: white;
            border-radius: 20px;
            width: fit-content;
            margin-left: auto;
            margin-right: auto;
        }

        p {
            font-size: 16px;
            font-weight: 500;
            line-height: 1.4;
            margin-bottom: 30px;
        }

        .powered-by {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            opacity: 0.6;
        }

        .powered-text {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--text-dim);
        }

        .mini-logo {
            width: 24px;
        }

        .tagline {
            font-size: 13px;
            font-weight: 400;
            color: var(--text-dim);
        }
    </style>
</head>
<body>
    <div class="glass-card">
        <div id="qrcode" style="display: none;"></div>
        
        <p id="instruction-text">Detecting device...</p>
        
        <div class="powered-by">
            <span class="powered-text">Powered by</span>
            <img src="https://web3kev.github.io/Brrrowser/assets/IconBrrr.png" alt="Brrrowser" class="mini-logo">
            <span class="powered-text">Brrrowser</span>
            <span class="tagline">Web Haptic & Web AR browser</span>
        </div>
    </div>

    <script>
        function init() {
            const el = document.getElementById('instruction-text');
            const qrContainer = document.getElementById('qrcode');
            
            // 1. Get URL parameters
            const urlParams = new URLSearchParams(window.location.search);
            const targetUrl = urlParams.get('url');
            const hasUrlParam = !!targetUrl;

            // 2. Device Detection Logic
            const ua = navigator.userAgent;
            const isAndroid = /Android/i.test(ua);
            const isIOS = /iPad|iPhone|iPod/.test(ua) || 
                          (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1);

            // 3. Logic Execution
            if (isAndroid && hasUrlParam) {
                // Instant redirect for Android mobile
                el.innerHTML = "Redirecting to experience...";
                window.location.href = targetUrl;
                return;
            }

            if (isIOS) {
                // iOS logic: focus on App Clip banner
                qrContainer.style.display = 'none';
                el.innerHTML = "Open the app clip banner or card to begin.";
            } else if (hasUrlParam) {
                // Desktop logic: Show QR code for current page so mobile can open it
                qrContainer.style.display = 'block';
                new QRCode(qrContainer, {
                    text: window.location.href,
                    width: 180,
                    height: 180,
                    colorDark : "#000000",
                    colorLight : "#ffffff",
                    correctLevel : QRCode.CorrectLevel.H
                });
                el.innerHTML = "Scan this code with your iPhone, iPad or AR capable Android device to open this experience.";
            } else {
                // Fallback if no URL is provided
                el.innerHTML = "Open this page on a mobile device to begin.";
            }
        }

        // Run on load
        window.onload = init;
    </script>
</body>
</html>
